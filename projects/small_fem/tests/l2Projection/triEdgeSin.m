close all;
clear all;

%% l2 [Order][Mesh]

%% f = [Sin(10x),  Sin(10y)]

%l2 = ...
%    [...
%        +1.041485e+00 , +1.207660e+00 , +7.219361e-01 , +1.964883e-01 , +5.637472e-02 ; ...
%        +1.513764e+00 , +1.129599e+00 , +2.712303e-01 , +5.000654e-02 , +6.134068e-03 ; ...
%        +1.270354e+00 , +7.656473e-01 , +1.015560e-01 , +6.241591e-03 , +4.540812e-04 ; ...
%    ];

%l2 = ...
%    [...
%        +1.041485e+00 , +1.207660e+00 , +7.219361e-01 , +1.964883e-01 , +5.637472e-02 ; ...
%        +1.513764e+00 , +1.129599e+00 , +2.712303e-01 , +5.000654e-02 , +6.134068e-03 ; ...
%        +1.270354e+00 , +7.656473e-01 , +1.015560e-01 , +6.241591e-03 , +4.540812e-04 ; ...
%        +1.162454e+00 , +3.012352e-01 , +2.098705e-02 , +9.771140e-04 , +2.967028e-05 ; ...
%        +1.201070e+00 , +2.267633e-01 , +5.709956e-03 , +8.240245e-05 , +1.474813e-06 ; ...
%        +9.548730e-01 , +5.082603e-02 , +8.005095e-04 , +9.345473e-06 , +7.131466e-08 ; ...
%        +8.704572e-01 , +2.954404e-02 , +1.667016e-04 , +5.664633e-07 , +2.450728e-09 ; ...
%        +5.777118e-01 , +3.932677e-03 , +1.714690e-05 , +4.996164e-08 , +9.684688e-11 ; ...
%    ];

l2 = ...
    [...
        +1.041485e+00 , +1.207660e+00 , +7.219361e-01 , +1.964883e-01 , +5.637472e-02 , +1.462308e-02 , +3.824017e-03 ; ...
        +1.513764e+00 , +1.129599e+00 , +2.712303e-01 , +5.000654e-02 , +6.134068e-03 , +7.513997e-04 , +9.022516e-05 ; ...
        +1.270354e+00 , +7.656473e-01 , +1.015560e-01 , +6.241591e-03 , +4.540812e-04 , +2.983316e-05 , +1.748217e-06 ; ...
        +1.162454e+00 , +3.012352e-01 , +2.098705e-02 , +9.771140e-04 , +2.967028e-05 , +9.289381e-07 , +2.901876e-08 ; ...
        +1.201070e+00 , +2.267633e-01 , +5.709956e-03 , +8.240245e-05 , +1.474813e-06 , +2.312831e-08 , +3.712882e-10 ; ...
        +9.548730e-01 , +5.082603e-02 , +8.005095e-04 , +9.345473e-06 , +7.131466e-08 , +5.633455e-10 , +4.327837e-12 ; ...
        +8.704572e-01 , +2.954404e-02 , +1.667016e-04 , +5.664633e-07 , +2.450728e-09 , +1.028186e-11 , +4.041324e-14 ; ...
        +5.777118e-01 , +3.932677e-03 , +1.714690e-05 , +4.996164e-08 , +9.684688e-11 , +1.889625e-13 , +1.064894e-14 ; ...
    ];

h = [2, 1, 1/2, 1/4, 1/8, 1/16, 1/32];
p = [1:8];

P = size(p, 2);
H = size(h, 2);

delta = zeros(P, H - 1);

for i = 1:H-1
    delta(:, i) = ...
        (log10(l2(:, i + 1)) - log10(l2(:, i))) / ...
        (log10(1/h(i + 1))   - log10(1/h(i)));
end

delta

figure;
loglog(1./h, l2, '-*');
grid;
