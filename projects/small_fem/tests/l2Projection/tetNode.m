close all;
clear all;

h = [1, 0.5, 0.25, 0.125, 0.0625];
p = [1:5];

l2 = ...
    [...
        +1.221292e+00 , +6.965580e-01 , +2.486713e-01 , +6.347816e-02 , +1.429043e-02 ; ...
        +1.084505e+00 , +2.556219e-01 , +4.957813e-02 , +8.055992e-03 , +1.217935e-03 ; ...
        +7.010126e-01 , +9.644356e-02 , +6.957166e-03 , +4.621930e-04 , +2.766942e-05 ; ...
        +3.209932e-01 , +2.065769e-02 , +9.564855e-04 , +3.421744e-05 , +1.204668e-06 ; ...
        +3.070231e-01 , +5.301100e-03 , +8.362316e-05 , +1.339323e-06 , +2.031384e-08 ; ...
    ];

P = size(p, 2);
H = size(h, 2);

delta = zeros(P, H - 1);

for i = 1:H-1
  delta(:, i) = ...
    (log10(l2(:, i + 1)) - log10(l2(:, i))) / ...
    (log10(1/h(i + 1))   - log10(1/h(i)));
end

delta

figure;
loglog(1./h, l2', '-*');
grid;
title('tet: Nodal');

xlabel('1/h [-]');
ylabel('L2 Error [-]');
